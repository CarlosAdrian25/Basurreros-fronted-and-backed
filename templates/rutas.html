{% extends "base.html" %}

{% block title %}Gestión de Rutas{% endblock %}

{% block header %}
Gestión de Rutas Predefinidas
{% endblock %}

{% block content %}
<div class="container my-4">
    <h2 class="text-center mb-4">Gestión de Rutas Predefinidas</h2>

    <!-- Botón para crear una nueva ruta -->
    <div class="text-end mb-3">
        <a style="color:white;background-color: #006BA6;" href="{{ url_for('web_bp.crear_ruta') }}" class="btn ">Crear Nueva Ruta</a>
    </div>

    <!-- Tabla de rutas -->
    <div class="card">
        <div style="background-color: #0089B8;" class="card-header text-white">
            <strong>Lista de Rutas</strong>
        </div>
        <div class="card-body p-0">
            <table class="table table-bordered text-center m-0" id="rutasTable">
                <thead>
                    <tr>
                        <th>Nombre de la Ruta</th>
                        <th>Acciones</th>
                    </tr>
                </thead>
                <tbody>
                    {% for ruta in rutas %}
                    <tr>
                        <td>{{ ruta.nombre }}</td>
                        <td>
                            <a style="color: white; background-color: #0E2761;" href="{{ url_for('web_bp.editar_ruta', ruta_id=ruta.id) }}" class="btn btn-sm">Editar</a>
                            <button class="btn btn-danger btn-sm" onclick="eliminarRuta('{{ ruta.id }}')">Eliminar</button>
                        </td>
                    </tr>
                    {% endfor %}
                </tbody>
            </table>
        </div>
    </div>
</div>

<script>
    function eliminarRuta(rutaId) {
        if (confirm('¿Estás seguro de que deseas eliminar esta ruta?')) {
            fetch(`/web/eliminar_ruta/${rutaId}`, { method: 'DELETE' })
                .then(response => {
                    if (response.ok) {
                        alert('Ruta eliminada correctamente.');
                        location.reload();
                    } else {
                        alert('Error al eliminar la ruta.');
                    }
                })
                .catch(error => {
                    console.error('Error:', error);
                    alert('Error de conexión al eliminar la ruta.');
                });
        }
    }
</script>
{% endblock %}
